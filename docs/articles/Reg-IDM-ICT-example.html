<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reg-IDM-ICT-example • HIDeM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reg-IDM-ICT-example">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HIDeM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Reg-IDM-ICT-example.html">Reg-IDM-ICT-example</a>
    </li>
    <li>
      <a href="../articles/Reg-IDM-ICT-Paq1000.html">Reg-IDM-ICT-Paq1000</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reg-IDM-ICT-example</h1>
            
      

      <div class="hidden name"><code>Reg-IDM-ICT-example.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="install-the-package">Install the package<a class="anchor" aria-label="anchor" href="#install-the-package"></a>
</h2>
<p>The HIDeM package is avaible on github, using the following commands
:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"arianebercu/HIDeM"</span><span class="op">)</span></span></code></pre></div>
<p>The HIDeM package depends on other R package, namely :</p>
<ul>
<li>lava (&gt;= 1.4.1),</li>
<li>mvtnorm (&gt;= 1.0-3),</li>
<li>marqLevAlg (&gt; 2.0),</li>
<li>doParallel,</li>
<li>foreach,</li>
<li>parallel,</li>
<li>MASS,</li>
<li>graphics,</li>
<li>grDevices,</li>
<li>stats,</li>
<li>ggplot2,</li>
<li>pracma</li>
</ul>
<p>We are using foreach, parallel and doParallel for parallelizing some
time consuming functions, mvtnorm for generating random parameters in
simulation, marqLevAlg (&gt;2.0) for the numerical optimization.</p>
<p>License: GPL (&gt;= 2) RoxygenNote: 7.3.2 Encoding: UTF-8</p>
</div>
<div class="section level2">
<h2 id="simulation-interval-censored-data">Simulation interval censored data<a class="anchor" aria-label="anchor" href="#simulation-interval-censored-data"></a>
</h2>
<p>We have a sample of N=2000 individuals, followed during 18 years with
visit scheduled every 2.5 years (0.5 variability) and at each visit a
probability of being lost to follow-up of 5%.</p>
<p>In IDM, we simulate transition intensities defined as,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∀</mo><mi>h</mi><mi>l</mi><mo>∈</mo><mn>01</mn><mo>,</mo><mn>02</mn><mo>,</mo><mn>12</mn><mo>,</mo><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><mspace width="1.0em"></mspace><msub><mi>α</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><mo>,</mo><msub><mi>β</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><mo>,</mo><msub><mi>Z</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mrow><mn>0</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>e</mi><mrow><msubsup><mi>β</mi><mrow><mi>h</mi><mi>l</mi></mrow><mi>⊤</mi></msubsup><msub><mi>Z</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub></mrow></msup></mrow><annotation encoding="application/x-tex">\begin{equation*} \label{eq:2}
\forall hl \in 01,02,12, \quad \quad \quad
\alpha_{hl}(t|\theta_{hl},\beta_{hl}, Z_{hl}) = \alpha_{0,hl}(t|\theta_{hl})e^{\beta_{hl}^\top Z_{hl}}
\end{equation*}</annotation></semantics></math></p>
<p>In this example, we choose to simulate 50 covariates having an
independent Gaussian distribution (centered and reduced),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>01</mn></msub><mo>=</mo><msub><mi>Z</mi><mn>02</mn></msub><mo>=</mo><msub><mi>Z</mi><mn>12</mn></msub><mo>=</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z_{01}=Z_{02}=Z_{12}=Z</annotation></semantics></math>.
Each covariate has a transition specific effect, on transition healthy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math>
diseased
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>01</mn></msub><annotation encoding="application/x-tex">\beta_{01}</annotation></semantics></math>,
healthy
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math>
deceased
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>02</mn></msub><annotation encoding="application/x-tex">\beta_{02}</annotation></semantics></math>
and diseased
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>→</mo><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math>
deceased
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\beta_{12}</annotation></semantics></math>.</p>
<table class="table">
<caption>
</caption>
<thead><tr>
<th style="text-align:left;">
Transition
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>1</mn></msub><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>3</mn></msub><annotation encoding="application/x-tex">\beta_3</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>4</mn></msub><annotation encoding="application/x-tex">\beta_4</annotation></semantics></math>
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>10</mn></msub><annotation encoding="application/x-tex">\beta_{10}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>11</mn></msub><annotation encoding="application/x-tex">\beta_{11}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\beta_{12}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>13</mn></msub><annotation encoding="application/x-tex">\beta_{13}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>14</mn></msub><annotation encoding="application/x-tex">\beta_{14}</annotation></semantics></math>
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>20</mn></msub><annotation encoding="application/x-tex">\beta_{20}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>21</mn></msub><annotation encoding="application/x-tex">\beta_{21}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>22</mn></msub><annotation encoding="application/x-tex">\beta_{22}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>23</mn></msub><annotation encoding="application/x-tex">\beta_{23}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>24</mn></msub><annotation encoding="application/x-tex">\beta_{24}</annotation></semantics></math>
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>30</mn></msub><annotation encoding="application/x-tex">\beta_{30}</annotation></semantics></math>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 1</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.8
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 2</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.8
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 \rightarrow 2</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
-0.8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>
</caption>
<thead><tr>
<th style="text-align:left;">
Transition
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>31</mn></msub><annotation encoding="application/x-tex">\beta_{31}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>32</mn></msub><annotation encoding="application/x-tex">\beta_{32}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>33</mn></msub><annotation encoding="application/x-tex">\beta_{33}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>34</mn></msub><annotation encoding="application/x-tex">\beta_{34}</annotation></semantics></math>
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>40</mn></msub><annotation encoding="application/x-tex">\beta_{40}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>41</mn></msub><annotation encoding="application/x-tex">\beta_{41}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>42</mn></msub><annotation encoding="application/x-tex">\beta_{42}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>43</mn></msub><annotation encoding="application/x-tex">\beta_{43}</annotation></semantics></math>
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>44</mn></msub><annotation encoding="application/x-tex">\beta_{44}</annotation></semantics></math>
</th>
<th style="text-align:left;">
…
</th>
<th style="text-align:right;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>50</mn></msub><annotation encoding="application/x-tex">\beta_{50}</annotation></semantics></math>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 1</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 2</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 \rightarrow 2</annotation></semantics></math>
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
-0.5
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>Following, the baseline transition intensity follows a Weibull
distribution,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mn>0</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mo>,</mo><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mi>h</mi><mi>l</mi></mrow></msub><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\displaystyle {\alpha_{0,hl}(t|\theta_{1,hl},\theta_{2,hl})=\theta_{1,hl}\theta_{2,hl}(\theta_{2,hl}t)^{\theta_{1,hl}-1}}</annotation></semantics></math></p>
<p>such that,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mn>01</mn></mrow></msub><mo>,</mo><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mn>01</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3.4</mn><mo>,</mo><mn>0.075</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\theta_{1,01},\theta_{2,01})=(3.4,0.075)</annotation></semantics></math>,<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mn>02</mn></mrow></msub><mo>,</mo><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mn>02</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3.4</mn><mo>,</mo><mn>0.085</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\theta_{1,02},\theta_{2,02})=(3.4,0.085)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mn>1</mn><mo>,</mo><mn>12</mn></mrow></msub><mo>,</mo><msub><mi>θ</mi><mrow><mn>2</mn><mo>,</mo><mn>12</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>3.4</mn><mo>,</mo><mn>0.07</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\theta_{1,12},\theta_{2,12})=(3.4,0.07)</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">HIDeM</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: prodlim</span></span>
<span><span class="va">n_var</span><span class="op">&lt;-</span><span class="fl">50</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">23</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">23</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.8</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">23</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">33</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">33</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">[</span><span class="fl">31</span><span class="op">:</span><span class="fl">33</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BETA01</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">43</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">BETA02</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">43</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">BETA12</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">43</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">id02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">BETA02</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">id01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">BETA01</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">id12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">BETA12</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cov</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="va">n_var</span>,nrow<span class="op">=</span><span class="va">n_var</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">cov</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co">#scale.waittime=0.18,shape.waittime=1.8,</span></span>
<span><span class="co">#scale.lifetime=0.15,shape.lifetime=2.3,</span></span>
<span><span class="co">#scale.illtime=0.14,shape.illtime=2.2,</span></span>
<span><span class="va">rep</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span><span class="va">simu</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/simulateIDM.html">simulateIDM</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2000</span>,seed<span class="op">=</span><span class="va">rep</span>,</span>
<span>                  scale.waittime<span class="op">=</span><span class="fl">0.07</span>,shape.waittime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  scale.lifetime<span class="op">=</span><span class="fl">0.085</span>,shape.lifetime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  scale.illtime<span class="op">=</span><span class="fl">0.075</span>,shape.illtime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  prob.censoring<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                  n.inspections<span class="op">=</span><span class="fl">8</span>,</span>
<span>                  administrative.censoring <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                  schedule<span class="op">=</span><span class="fl">2.5</span>,punctuality<span class="op">=</span><span class="fl">0.5</span>,nvar<span class="op">=</span><span class="va">n_var</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">)</span>,cov<span class="op">=</span><span class="va">cov</span>,</span>
<span>                  x01<span class="op">=</span><span class="va">id01</span>,x02<span class="op">=</span><span class="va">id02</span>,x12<span class="op">=</span><span class="va">id12</span>,</span>
<span>                  beta01<span class="op">=</span><span class="va">BETA01</span><span class="op">[</span><span class="va">BETA01</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>,beta02<span class="op">=</span><span class="va">BETA02</span><span class="op">[</span><span class="va">BETA02</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                  beta12<span class="op">=</span><span class="va">BETA12</span><span class="op">[</span><span class="va">BETA12</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>In the output
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>m</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">simu</annotation></semantics></math>,
you have two elements : the dataset $data and explanatory plots
$plot.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   administrative.censoring censtime          X1          X2         X3</span></span>
<span><span class="co">#&gt; 1                       18 17.82195  0.11003565  0.88847608  0.2626667</span></span>
<span><span class="co">#&gt; 2                       18 17.69103  0.80872054 -0.01815571  0.7039617</span></span>
<span><span class="co">#&gt; 3                       18 12.56750 -0.08881676 -1.43234804 -0.2171928</span></span>
<span><span class="co">#&gt; 4                       18 17.86267  0.37026126 -0.93488728 -2.1802342</span></span>
<span><span class="co">#&gt; 5                       18 12.90958  0.40876006  0.65185053  1.8164008</span></span>
<span><span class="co">#&gt; 6                       18 17.84424 -0.46140748  1.21192198 -0.7193277</span></span>
<span><span class="co">#&gt;           X4         X5         X6         X7          X8          X9</span></span>
<span><span class="co">#&gt; 1 -0.4537282  0.1344390  1.0439527  1.1015952  1.09810420 -1.01576090</span></span>
<span><span class="co">#&gt; 2 -0.4006717 -1.2599078  1.4562122 -0.1453585  0.12262308 -0.27469994</span></span>
<span><span class="co">#&gt; 3 -1.8173789 -1.3909747 -0.3834196  0.3288282 -0.45951031 -0.04665278</span></span>
<span><span class="co">#&gt; 4 -0.7843964  1.7404905  0.4096513 -1.6242129  1.16709374  1.19147454</span></span>
<span><span class="co">#&gt; 5 -0.5119064 -0.5415008 -0.6417391  0.3996244  0.09093332  1.39108508</span></span>
<span><span class="co">#&gt; 6 -2.9254275 -1.2615707  1.1549423 -1.5908737  0.77133904 -1.91238494</span></span>
<span><span class="co">#&gt;          X10        X11          X12        X13         X14         X15</span></span>
<span><span class="co">#&gt; 1 -1.4181857  0.8410758  0.033104620 -0.8546097  0.21510070 -0.14925083</span></span>
<span><span class="co">#&gt; 2 -0.9131192  0.3866649  0.001321339  0.4444228 -1.35963066 -0.05169343</span></span>
<span><span class="co">#&gt; 3  0.9264366  0.2244227 -0.118933200 -0.4388973 -0.37139426  0.66795814</span></span>
<span><span class="co">#&gt; 4 -1.2540619  1.1401437  0.104256321  1.1787564  0.27316333  0.96132429</span></span>
<span><span class="co">#&gt; 5  0.2834529 -0.9124940  0.659282801 -0.6651984 -2.48827581 -0.18641962</span></span>
<span><span class="co">#&gt; 6  2.0633930  0.3138239 -0.137820679  1.5212964  0.08446438 -1.10615873</span></span>
<span><span class="co">#&gt;           X16        X17        X18        X19        X20         X21</span></span>
<span><span class="co">#&gt; 1  1.34022520  1.1410183  1.1305911 -0.1011244 -0.7121795 -1.06698850</span></span>
<span><span class="co">#&gt; 2 -0.38869647  1.9333108  0.9709379  0.2313941 -0.1117647  0.47322567</span></span>
<span><span class="co">#&gt; 3 -0.80339903  2.0529007  2.1212976  0.1951305  0.5932131 -0.08028486</span></span>
<span><span class="co">#&gt; 4  0.18567908 -0.4628326  0.4522474 -1.2291170 -0.8527420  0.48858136</span></span>
<span><span class="co">#&gt; 5 -0.17196715  1.6583004  0.1726265  0.9553336 -0.1088505 -0.46899819</span></span>
<span><span class="co">#&gt; 6 -0.09814262  1.1832686 -1.1514940  0.3006883 -1.2417545  1.55539294</span></span>
<span><span class="co">#&gt;          X22        X23        X24        X25         X26        X27        X28</span></span>
<span><span class="co">#&gt; 1 -1.4464460 -0.6828503 -0.7882967  0.5158212 -0.97968392 -0.4054548  1.2217143</span></span>
<span><span class="co">#&gt; 2 -1.7354146 -0.3973901 -1.4616460 -0.1061886  1.13613013  1.2096045 -1.0721394</span></span>
<span><span class="co">#&gt; 3 -1.8093657 -1.1012463 -1.2261102  0.5881068  0.83011439 -1.5639193 -0.3104641</span></span>
<span><span class="co">#&gt; 4  0.3600848  1.6657697  0.6245576  1.8136031  0.04330697  0.5026616  1.0914668</span></span>
<span><span class="co">#&gt; 5 -0.3582909 -1.6195286 -0.2432343 -0.1331454  1.02810076  0.8638691  0.3162520</span></span>
<span><span class="co">#&gt; 6  1.5306088 -0.5069776 -0.9310536  1.3117807 -0.07895539 -0.2692194  2.0077155</span></span>
<span><span class="co">#&gt;          X29        X30        X31          X32        X33         X34</span></span>
<span><span class="co">#&gt; 1  1.2332815 -1.6915696 -1.0322074  0.199524889  0.9604876  0.97031060</span></span>
<span><span class="co">#&gt; 2 -1.1597015 -0.5984877 -0.8571623  2.069386739  1.0337467  1.35482082</span></span>
<span><span class="co">#&gt; 3 -1.7488465  0.3649211 -0.3844939 -0.520146673 -0.4956850  0.12675127</span></span>
<span><span class="co">#&gt; 4  1.2671623  1.2428643  0.7987524 -1.251652421  0.5952119  0.52055591</span></span>
<span><span class="co">#&gt; 5 -0.2514775  0.1908916  0.1076132  1.169688169 -0.2250013 -0.01395286</span></span>
<span><span class="co">#&gt; 6  0.8306908  0.5063441 -1.0057373 -0.007152392  0.6018516 -0.10723978</span></span>
<span><span class="co">#&gt;         X35        X36        X37        X38        X39         X40        X41</span></span>
<span><span class="co">#&gt; 1  1.796896 -1.2606268  1.1351026  0.4972043 -1.5331327  0.68066100 -0.8213516</span></span>
<span><span class="co">#&gt; 2 -1.121241 -1.0220906  0.1681037 -1.4587660 -1.0064947 -0.04925656 -0.3601769</span></span>
<span><span class="co">#&gt; 3 -2.075977 -0.6436006 -0.5698265  1.0280139  1.9277506  0.21766920 -2.6606788</span></span>
<span><span class="co">#&gt; 4 -1.227818  0.2957489 -0.2981521  0.5994889  0.4500641  1.69927381 -0.8259098</span></span>
<span><span class="co">#&gt; 5  1.929720 -0.1287624 -0.8448102  0.9285087 -0.3049276  0.24587686  0.5139684</span></span>
<span><span class="co">#&gt; 6 -0.273591 -0.4395671  0.9816650 -0.1831086  2.1493693  0.47407436  0.2516739</span></span>
<span><span class="co">#&gt;           X42         X43        X44        X45         X46         X47</span></span>
<span><span class="co">#&gt; 1 -1.06445554 -0.16242828  1.4948667  1.3404677 -0.02165721 -1.00846517</span></span>
<span><span class="co">#&gt; 2  1.55389308  0.03381937  0.8173279 -1.1157120  0.98448042  0.73942441</span></span>
<span><span class="co">#&gt; 3 -0.19036960 -1.09362512 -0.1539752  1.5065385 -0.68091825  0.04548124</span></span>
<span><span class="co">#&gt; 4  0.66743315  0.57234695  0.1833405 -1.6099660 -0.26052233 -0.46466759</span></span>
<span><span class="co">#&gt; 5 -0.01135271 -1.27902820 -0.4150356  0.9829932 -0.58467693 -1.32641715</span></span>
<span><span class="co">#&gt; 6 -0.77262138 -0.29423746 -0.8517042 -0.5279514  0.07643917 -1.33313481</span></span>
<span><span class="co">#&gt;          X48        X49         X50   illtime illstatus  lifetime         L</span></span>
<span><span class="co">#&gt; 1  0.6408445 -1.8923489 -0.89691455  5.859810         1  6.751371  5.243818</span></span>
<span><span class="co">#&gt; 2 -1.6013778  1.2928042  0.18484918  7.673935         0  3.141535  2.965152</span></span>
<span><span class="co">#&gt; 3 -0.7778154 -0.6182543  1.58784533 14.148797         1 15.031181 12.567500</span></span>
<span><span class="co">#&gt; 4 -1.6473925  1.0409383 -1.13037567 46.770059         0 14.173718 12.900042</span></span>
<span><span class="co">#&gt; 5  0.1542662  1.1758795 -0.08025176  4.334944         1  5.140210  2.779674</span></span>
<span><span class="co">#&gt; 6 -1.1756313 -1.5018321  0.13242028 12.686026         1 13.426249 12.593408</span></span>
<span><span class="co">#&gt;           R observed.lifetime seen.ill seen.exit       T01       T02       T12</span></span>
<span><span class="co">#&gt; 1  5.243818          6.751371        0         1  5.859810 10.240752  6.751371</span></span>
<span><span class="co">#&gt; 2  2.965152          3.141535        0         1  7.673935  3.141535  3.141535</span></span>
<span><span class="co">#&gt; 3 12.567500         15.031181        0         1 14.148797 25.415135 15.031181</span></span>
<span><span class="co">#&gt; 4 12.900042         14.173718        0         1 46.770059 14.173718 14.173718</span></span>
<span><span class="co">#&gt; 5  2.779674          5.140210        0         1  4.334944  6.871252  5.140210</span></span>
<span><span class="co">#&gt; 6 12.593408         13.426249        0         1 12.686026 30.010175 13.426249</span></span>
<span><span class="co">#&gt;   id.nodem.death</span></span>
<span><span class="co">#&gt; 1              1</span></span>
<span><span class="co">#&gt; 2              0</span></span>
<span><span class="co">#&gt; 3              0</span></span>
<span><span class="co">#&gt; 4              0</span></span>
<span><span class="co">#&gt; 5              1</span></span>
<span><span class="co">#&gt; 6              1</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary" class="external-link">gtsummary</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="va">var</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_var</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">summaries</span><span class="op">&lt;-</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span><span class="op">[</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">var</span><span class="op">]</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>illstatus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">illstatus</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Ill"</span>,<span class="st">"Healthy"</span><span class="op">)</span>,</span>
<span>          id.nodem.death<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">id.nodem.death</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Yes"</span>,<span class="st">"No"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"L = time of last visit illness-free"</span> <span class="op">=</span> <span class="va">L</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"R = diagnosis visit time"</span> <span class="op">=</span> <span class="va">R</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"illstatus = true indicator of illness "</span><span class="op">=</span><span class="va">illstatus</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"observed.lifetime = time of death"</span> <span class="op">=</span> <span class="va">observed.lifetime</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"lifetime = time of death with IC on illness"</span> <span class="op">=</span> <span class="va">lifetime</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"T01 = simulated time on transition to illness"</span><span class="op">=</span><span class="va">T01</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"T02 = simulated time on transition to death illness-free"</span><span class="op">=</span><span class="va">T02</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"T12 = simulated time on transition to death with illness"</span><span class="op">=</span><span class="va">T12</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"administrative.censoring = 18"</span><span class="op">=</span><span class="va">administrative.censoring</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"censtime = simulated last visit"</span><span class="op">=</span><span class="va">censtime</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="st">"id.nodem.death = illness not observed due to death"</span><span class="op">=</span><span class="va">id.nodem.death</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seen.ill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">seen.ill</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Ill"</span>,<span class="st">"Healthy"</span><span class="op">)</span>,</span>
<span>          seen.exit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">seen.exit</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Death"</span>,<span class="st">"Alive"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_strata.html" class="external-link">tbl_strata</a></span><span class="op">(</span></span>
<span>     strata <span class="op">=</span> <span class="va">seen.ill</span>,</span>
<span>     .tbl_fun <span class="op">=</span></span>
<span>       <span class="op">~</span> <span class="va">.x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>       <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html" class="external-link">tbl_summary</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">seen.exit</span>,</span>
<span>                   type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="st">"continuous2"</span><span class="op">)</span>,</span>
<span>                   statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                     <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_categorical</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{n} ({p}%)"</span></span>
<span>                   <span class="op">)</span>,</span>
<span>                   digits <span class="op">=</span> <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>     .header <span class="op">=</span> <span class="st">"**{strata}**, N = {n}"</span></span>
<span>   <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/modify_caption.html" class="external-link">modify_caption</a></span><span class="op">(</span><span class="st">"Characteristics of individuals in simulated dataset"</span><span class="op">)</span></span>
<span><span class="va">summaries</span></span></code></pre></div>
<div id="bqrqihxaiv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bqrqihxaiv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bqrqihxaiv thead, #bqrqihxaiv tbody, #bqrqihxaiv tfoot, #bqrqihxaiv tr, #bqrqihxaiv td, #bqrqihxaiv th {
  border-style: none;
}

#bqrqihxaiv p {
  margin: 0;
  padding: 0;
}

#bqrqihxaiv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bqrqihxaiv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bqrqihxaiv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bqrqihxaiv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bqrqihxaiv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqrqihxaiv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqrqihxaiv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bqrqihxaiv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bqrqihxaiv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bqrqihxaiv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bqrqihxaiv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bqrqihxaiv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bqrqihxaiv .gt_spanner_row {
  border-bottom-style: hidden;
}

#bqrqihxaiv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bqrqihxaiv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bqrqihxaiv .gt_from_md > :first-child {
  margin-top: 0;
}

#bqrqihxaiv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bqrqihxaiv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bqrqihxaiv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bqrqihxaiv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bqrqihxaiv .gt_row_group_first td {
  border-top-width: 2px;
}

#bqrqihxaiv .gt_row_group_first th {
  border-top-width: 2px;
}

#bqrqihxaiv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqrqihxaiv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bqrqihxaiv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bqrqihxaiv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqrqihxaiv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqrqihxaiv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bqrqihxaiv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bqrqihxaiv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bqrqihxaiv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bqrqihxaiv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqrqihxaiv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqrqihxaiv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bqrqihxaiv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bqrqihxaiv .gt_left {
  text-align: left;
}

#bqrqihxaiv .gt_center {
  text-align: center;
}

#bqrqihxaiv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bqrqihxaiv .gt_font_normal {
  font-weight: normal;
}

#bqrqihxaiv .gt_font_bold {
  font-weight: bold;
}

#bqrqihxaiv .gt_font_italic {
  font-style: italic;
}

#bqrqihxaiv .gt_super {
  font-size: 65%;
}

#bqrqihxaiv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bqrqihxaiv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bqrqihxaiv .gt_indent_1 {
  text-indent: 5px;
}

#bqrqihxaiv .gt_indent_2 {
  text-indent: 10px;
}

#bqrqihxaiv .gt_indent_3 {
  text-indent: 15px;
}

#bqrqihxaiv .gt_indent_4 {
  text-indent: 20px;
}

#bqrqihxaiv .gt_indent_5 {
  text-indent: 25px;
}

#bqrqihxaiv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bqrqihxaiv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><span class="gt_from_md">Characteristics of individuals in simulated dataset</span></caption>
  <thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="level 1; stat_1_1">
        <div class="gt_column_spanner"><span class="gt_from_md"><strong>Healthy</strong>, N = 1457</span></div>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="level 1; stat_1_2">
        <div class="gt_column_spanner"><span class="gt_from_md"><strong>Ill</strong>, N = 543</span></div>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_1">
<span class="gt_from_md"><strong>Alive</strong><br>
N = 174</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_1">
<span class="gt_from_md"><strong>Death</strong><br>
N = 1,283</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_2">
<span class="gt_from_md"><strong>Alive</strong><br>
N = 203</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_2">
<span class="gt_from_md"><strong>Death</strong><br>
N = 340</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">administrative.censoring = 18</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
<td headers="stat_2_1" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
<td headers="stat_1_2" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
<td headers="stat_2_2" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">censtime = simulated last visit</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">17.57 (5.35, 17.77)</td>
<td headers="stat_2_1" class="gt_row gt_center">17.63 (10.37, 17.82)</td>
<td headers="stat_1_2" class="gt_row gt_center">17.69 (17.56, 17.86)</td>
<td headers="stat_2_2" class="gt_row gt_center">17.68 (17.54, 17.82)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">illtime</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">22.13 (17.04, 30.83)</td>
<td headers="stat_2_1" class="gt_row gt_center">12.99 (9.14, 18.32)</td>
<td headers="stat_1_2" class="gt_row gt_center">9.38 (6.68, 12.74)</td>
<td headers="stat_2_2" class="gt_row gt_center">5.95 (4.19, 8.75)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">illstatus = true indicator of illness </td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Healthy</td>
<td headers="stat_1_1" class="gt_row gt_center">123 (71%)</td>
<td headers="stat_2_1" class="gt_row gt_center">1,057 (82%)</td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Ill</td>
<td headers="stat_1_1" class="gt_row gt_center">51 (29%)</td>
<td headers="stat_2_1" class="gt_row gt_center">226 (18%)</td>
<td headers="stat_1_2" class="gt_row gt_center">203 (100%)</td>
<td headers="stat_2_2" class="gt_row gt_center">340 (100%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">lifetime = time of death with IC on illness</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">25.46 (20.32, 31.00)</td>
<td headers="stat_2_1" class="gt_row gt_center">7.43 (4.97, 10.60)</td>
<td headers="stat_1_2" class="gt_row gt_center">23.71 (20.09, 29.08)</td>
<td headers="stat_2_2" class="gt_row gt_center">11.51 (8.62, 14.28)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">L = time of last visit illness-free</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">17.57 (5.35, 17.77)</td>
<td headers="stat_2_1" class="gt_row gt_center">5.22 (2.74, 7.83)</td>
<td headers="stat_1_2" class="gt_row gt_center">7.83 (5.27, 12.52)</td>
<td headers="stat_2_2" class="gt_row gt_center">5.18 (2.70, 7.65)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">R = diagnosis visit time</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">17.57 (5.35, 17.77)</td>
<td headers="stat_2_1" class="gt_row gt_center">5.22 (2.74, 7.83)</td>
<td headers="stat_1_2" class="gt_row gt_center">10.32 (7.69, 15.01)</td>
<td headers="stat_2_2" class="gt_row gt_center">7.66 (5.24, 10.22)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">observed.lifetime = time of death</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
<td headers="stat_2_1" class="gt_row gt_center">7.43 (4.97, 10.60)</td>
<td headers="stat_1_2" class="gt_row gt_center">18.00 (18.00, 18.00)</td>
<td headers="stat_2_2" class="gt_row gt_center">11.51 (8.62, 14.28)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">T01 = simulated time on transition to illness</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">22.13 (17.04, 30.83)</td>
<td headers="stat_2_1" class="gt_row gt_center">12.99 (9.14, 18.32)</td>
<td headers="stat_1_2" class="gt_row gt_center">9.38 (6.68, 12.74)</td>
<td headers="stat_2_2" class="gt_row gt_center">5.95 (4.19, 8.75)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">T02 = simulated time on transition to death illness-free</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">23.97 (19.35, 30.19)</td>
<td headers="stat_2_1" class="gt_row gt_center">7.73 (5.03, 11.28)</td>
<td headers="stat_1_2" class="gt_row gt_center">19.08 (13.60, 25.68)</td>
<td headers="stat_2_2" class="gt_row gt_center">13.10 (8.94, 18.76)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">T12 = simulated time on transition to death with illness</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">25.46 (20.32, 31.00)</td>
<td headers="stat_2_1" class="gt_row gt_center">7.43 (4.97, 10.60)</td>
<td headers="stat_1_2" class="gt_row gt_center">23.71 (20.09, 29.08)</td>
<td headers="stat_2_2" class="gt_row gt_center">11.51 (8.62, 14.28)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">id.nodem.death = illness not observed due to death</td>
<td headers="stat_1_1" class="gt_row gt_center">0 (0%)</td>
<td headers="stat_2_1" class="gt_row gt_center">132 (10%)</td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">    No</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center">203 (100%)</td>
<td headers="stat_2_2" class="gt_row gt_center">340 (100%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="5">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span class="gt_from_md">n (%)</span>
</td>
    </tr></tfoot>
</table>
</div>
<p>In $data, we have a line per individual observation with :</p>
<ul>
<li>seen.ill : observed illness (=1, ill)</li>
<li>seen.exit : indicator of death (=1, dead)</li>
<li>L : time of last visit illness-free (last visit for healthy
individual)</li>
<li>R : diagnosis visit time (r=l for healthy individual)</li>
<li>observed.lifetime : time of death (18 for alive individual)</li>
<li>illstatus : true indicator of illness (without interval
censoring)</li>
<li>lifetime : time of death knowing illstatus (without interval
censoring)</li>
<li>T01 : simulated time on transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 1</annotation></semantics></math>
</li>
<li>T02 : simulated time on transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 2</annotation></semantics></math>
</li>
<li>T12 : simulated time on transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 \rightarrow 2</annotation></semantics></math>
</li>
<li>id.nodem.death : illness not observed due to death (=1 if true)</li>
</ul>
<p>In $plot, we have 7 elements :</p>
<ul>
<li>[[1]] : survival baseline intensity simulated on each
transition</li>
<li>[[2]] : table of individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 1</annotation></semantics></math>
at given time points</li>
<li>[[3]] : plot of 3 individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 1</annotation></semantics></math>
at given time points (id=1,2 and 3)</li>
<li>[[4]] : table of individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 2</annotation></semantics></math>
at given time points</li>
<li>[[5]] : plot of 3 individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">0 \rightarrow 2</annotation></semantics></math>
at given time points (id=1,2 and 3)</li>
<li>[[6]] : table of individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 \rightarrow 2</annotation></semantics></math>
at given time points</li>
<li>[[7]] : plot of 3 individual survival for transition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>→</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">1 \rightarrow 2</annotation></semantics></math>
at given time points (id=1,2 and 3)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time      surv id</span></span>
<span><span class="co">#&gt; 1    1 0.9994622  1</span></span>
<span><span class="co">#&gt; 2    2 0.9943380  1</span></span>
<span><span class="co">#&gt; 3    3 0.9777143  1</span></span>
<span><span class="co">#&gt; 4    4 0.9418230  1</span></span>
<span><span class="co">#&gt; 5    5 0.8798570  1</span></span>
<span><span class="co">#&gt; 6    6 0.7882738  1</span></span>
<span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time      surv id</span></span>
<span><span class="co">#&gt; 1    1 0.9994949  1</span></span>
<span><span class="co">#&gt; 2    2 0.9946811  1</span></span>
<span><span class="co">#&gt; 3    3 0.9790539  1</span></span>
<span><span class="co">#&gt; 4    4 0.9452585  1</span></span>
<span><span class="co">#&gt; 5    5 0.8867251  1</span></span>
<span><span class="co">#&gt; 6    6 0.7997493  1</span></span>
<span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-5-3.png" width="576"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time       surv id</span></span>
<span><span class="co">#&gt; 1    1 0.99453602  1</span></span>
<span><span class="co">#&gt; 2    2 0.94380442  1</span></span>
<span><span class="co">#&gt; 3    3 0.79487710  1</span></span>
<span><span class="co">#&gt; 4    4 0.54306633  1</span></span>
<span><span class="co">#&gt; 5    5 0.27150981  1</span></span>
<span><span class="co">#&gt; 6    6 0.08862584  1</span></span>
<span><span class="va">simu</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-5-4.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="run-idm-ict">Run IDM-ICT<a class="anchor" aria-label="anchor" href="#run-idm-ict"></a>
</h2>
<p>In this section, we will explicit the profile likelihood, with an</p>
<ul>
<li>outer loop on penalty parameters noted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>λ</mi><mn>01</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>02</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,\lambda_{01},\lambda_{02},\lambda_{12})</annotation></semantics></math>,
and</li>
<li>an inner loop on regression parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>β</mi><mn>01</mn></msub><mo>,</mo><msub><mi>β</mi><mn>02</mn></msub><mo>,</mo><msub><mi>β</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\beta_{01},\beta_{02},\beta_{12})</annotation></semantics></math>
and baseline intensity parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mn>01</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>02</mn></msub><mo>,</mo><msub><mi>θ</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\theta_{01},\theta_{02},\theta_{12})</annotation></semantics></math>
</li>
</ul>
<p>Firstly, we need to perform a pre-selection of penalty parameters for
each transition separately. For each transition, we first fit
multi-state models including covariates only in the transition from
state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>,
and considering a grid of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{hl}</annotation></semantics></math>
with equidistant values from 0.0001 and 100 while keeping
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
fixed at 1. It is recommended to try multiple values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">]</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">]0,1]</annotation></semantics></math>,
but for this example we will limit to lasso penalty (a=1).</p>
<p>We choose to estimate the baseline intensity transition with M-spline
basis with nodes at 0, 9 and 18 years of follow-up. To initiative,
baseline intensities parameters of M-splines, we run a model without
covariates.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span>  </span>
<span>  <span class="va">mvoidexample</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">observed.lifetime</span>, event <span class="op">=</span> <span class="va">seen.exit</span><span class="op">)</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>                       formula01 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">L</span>,<span class="va">R</span><span class="op">)</span>, event <span class="op">=</span> <span class="va">seen.ill</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                       formula12 <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                       nproc<span class="op">=</span><span class="fl">1</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                       scale.X<span class="op">=</span><span class="cn">F</span>,</span>
<span>                       method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                       alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mvoidexample</span><span class="op">$</span><span class="va">theta01</span>,<span class="va">mvoidexample</span><span class="op">$</span><span class="va">theta02</span>,<span class="va">mvoidexample</span><span class="op">$</span><span class="va">theta12</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">nlambda</span><span class="op">&lt;-</span><span class="fl">20</span></span>
<span>  <span class="va">lambdatest</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">100</span>,length.out<span class="op">=</span><span class="va">nlambda</span><span class="op">)</span></span>
<span>  <span class="va">penalty</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">a</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"lasso"</span>,<span class="st">"elasticnet"</span><span class="op">)</span></span>
<span></span>
<span>  </span>
<span><span class="co">############################ 01 ################################################</span></span>
<span>    <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = observed.lifetime, event = seen.exit) ~1"</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(L,R), event = seen.ill) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"~1"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">m01example</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                    formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                    formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                                    penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    lambda01 <span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                    lambda02<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span>                                    lambda12<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,nproc<span class="op">=</span><span class="fl">2</span>,clustertype <span class="op">=</span> <span class="st">"PSOCK"</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="co">################################ 02 ############################################</span></span>
<span></span>
<span>  <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = observed.lifetime, event = seen.exit) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = list(L,R), event = seen.ill) ~ 1"</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"~1"</span><span class="op">)</span></span>
<span><span class="co">#setwd("C:/Users/ab17/Desktop/CURTA/SMOOTH_HAZARD/OPTIM_B_DIFFLAMBDA_derivaana_all/Weibull_simu/Scenario1")</span></span>
<span></span>
<span>  <span class="va">m02example</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                    formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                    formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                    lambda02 <span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                    lambda01<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span>                                    lambda12<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,nproc<span class="op">=</span><span class="fl">2</span>,clustertype <span class="op">=</span> <span class="st">"PSOCK"</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span></span>
<span><span class="co">######################################## 12 ###################################</span></span>
<span></span>
<span>  <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = observed.lifetime, event = seen.exit) ~1"</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = list(L,R), event = seen.ill) ~ 1"</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">m12example</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda01 <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>                                lambda12<span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,nproc<span class="op">=</span><span class="fl">2</span>,clustertype <span class="op">=</span> <span class="st">"PSOCK"</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  </span></code></pre></div>
<p>The ouput of each models can be displayed using standard function
such as print and summary :</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m01example</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m01example</span></span>
<span><span class="va">m02example</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m02example</span></span>
<span><span class="va">m12example</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m12example</span></span>
<span><span class="co">#print(m01example)</span></span>
<span><span class="co">#summary(m01example)</span></span>
<span></span>
<span><span class="co">#print(m02example)</span></span>
<span><span class="co">#summary(m02example)</span></span>
<span></span>
<span><span class="co">#print(m12example)</span></span>
<span><span class="co">#summary(m12example)</span></span></code></pre></div>
<p>The following step is to visualize the Bayesian Indicator Criteria
(BIC) and determine the 3 values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
per transition minimizing it :</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m01example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,<span class="va">m01example</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 0 -&gt; 1"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m02example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,<span class="va">m02example</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 0 -&gt; 2"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-8-2.png" width="576"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m12example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>,<span class="va">m12example</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 1 -&gt; 2"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-example_files/figure-html/unnamed-chunk-8-3.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lambda01</span><span class="op">&lt;-</span><span class="va">lambda02</span><span class="op">&lt;-</span><span class="va">lambda12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">############################## 01 ##############################################</span></span>
<span><span class="va">BIC01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m01example</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m01example</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC01</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m01example</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC01</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m01example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m01example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda01</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="co">############################## 02 ##############################################</span></span>
<span><span class="va">BIC02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m02example</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m02example</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC02</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m02example</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC02</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m02example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda02</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda02</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m02example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda02</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="co">############################## 12 ##############################################</span></span>
<span><span class="va">BIC12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m12example</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m12example</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC12</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m12example</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC12</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m12example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda12</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda12</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m12example</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda12</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="va">lambda01</span></span>
<span><span class="co">#&gt; [1] 36.84842 42.11105 47.37368</span></span>
<span><span class="va">lambda02</span></span>
<span><span class="co">#&gt; [1] 42.11105 47.37368 52.63632</span></span>
<span><span class="va">lambda12</span></span>
<span><span class="co">#&gt; [1] 31.58579 36.84842 42.11105</span></span></code></pre></div>
<p>Note that for each transition, we reached the minimum as we have this
U-shape of BIC values along
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
Once we have determined each value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
we have 27 combinations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>01</mn></msub><annotation encoding="application/x-tex">\lambda_{01}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>02</mn></msub><annotation encoding="application/x-tex">\lambda_{02}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\lambda_{12}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a=1</annotation></semantics></math>,
leading to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>108</mn><annotation encoding="application/x-tex">108</annotation></semantics></math>
combinations in total. Now, we can estimate the full model and
ultimately select the combination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>λ</mi><mn>01</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>02</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,\lambda_{01},\lambda_{02},\lambda_{12})</annotation></semantics></math>
that minimizes the BIC.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>   <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = observed.lifetime, event = seen.exit) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(L,R), event = seen.ill) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">modelexample</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda01 <span class="op">=</span> <span class="va">lambda01</span>,</span>
<span>                                lambda12<span class="op">=</span> <span class="va">lambda12</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="va">lambda02</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                nproc<span class="op">=</span><span class="fl">2</span>,clustertype <span class="op">=</span> <span class="st">"PSOCK"</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  </span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">modelexample</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">modelexample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">)</span></span>
<span><span class="co">#&gt; Method: M-splines based on likelihood </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  2000 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;1':  543 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;2 or 0--&gt;1--&gt;2':  1623 </span></span>
<span><span class="co">#&gt; number of covariates:  50 50 50 </span></span>
<span><span class="co">#&gt; type of penalty:  lasso </span></span>
<span><span class="co">#&gt; range of lambda value '0--&gt;1':  36.84842 ; 47.37368 </span></span>
<span><span class="co">#&gt; range of lambda value '0--&gt;2':  42.11105 ; 52.63632 </span></span>
<span><span class="co">#&gt; range of lambda value '1--&gt;2':  31.58579 ; 42.11105 </span></span>
<span><span class="co">#&gt; observation deleted due to missing:  1 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Minimum BIC with convergence : BIC= 10952.52  </span></span>
<span><span class="co">#&gt;  with lambda ( 36.84842 ; 42.11105 ; 31.58579 ) and alpha = 1 </span></span>
<span><span class="co">#&gt; For transition '0--&gt;1': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio Selected</span></span>
<span><span class="co">#&gt;        X1       1.9409      Yes</span></span>
<span><span class="co">#&gt;        X2       1.8062      Yes</span></span>
<span><span class="co">#&gt;        X3       1.9689      Yes</span></span>
<span><span class="co">#&gt;        X4       1.0000       No</span></span>
<span><span class="co">#&gt;        X5       1.0000       No</span></span>
<span><span class="co">#&gt;        X6       1.0000       No</span></span>
<span><span class="co">#&gt;        X7       1.0000       No</span></span>
<span><span class="co">#&gt;        X8       1.0000       No</span></span>
<span><span class="co">#&gt;        X9       1.0000       No</span></span>
<span><span class="co">#&gt;       X10       1.0000       No</span></span>
<span><span class="co">#&gt;       X11       0.5185      Yes</span></span>
<span><span class="co">#&gt;       X12       0.7125      Yes</span></span>
<span><span class="co">#&gt;       X13       0.6396      Yes</span></span>
<span><span class="co">#&gt;       X14       1.0000       No</span></span>
<span><span class="co">#&gt;       X15       1.0000       No</span></span>
<span><span class="co">#&gt;       X16       1.0000       No</span></span>
<span><span class="co">#&gt;       X17       1.0000       No</span></span>
<span><span class="co">#&gt;       X18       1.0059      Yes</span></span>
<span><span class="co">#&gt;       X19       1.0000       No</span></span>
<span><span class="co">#&gt;       X20       1.0000       No</span></span>
<span><span class="co">#&gt;       X21       1.0000       No</span></span>
<span><span class="co">#&gt;       X22       1.0000       No</span></span>
<span><span class="co">#&gt;       X23       1.0000       No</span></span>
<span><span class="co">#&gt;       X24       1.0000       No</span></span>
<span><span class="co">#&gt;       X25       1.0000       No</span></span>
<span><span class="co">#&gt;       X26       1.0000       No</span></span>
<span><span class="co">#&gt;       X27       1.0000       No</span></span>
<span><span class="co">#&gt;       X28       1.0000       No</span></span>
<span><span class="co">#&gt;       X29       1.0000       No</span></span>
<span><span class="co">#&gt;       X30       0.9812      Yes</span></span>
<span><span class="co">#&gt;       X31       1.0000       No</span></span>
<span><span class="co">#&gt;       X32       1.0000       No</span></span>
<span><span class="co">#&gt;       X33       1.0000       No</span></span>
<span><span class="co">#&gt;       X34       1.0000       No</span></span>
<span><span class="co">#&gt;       X35       1.0000       No</span></span>
<span><span class="co">#&gt;       X36       1.0000       No</span></span>
<span><span class="co">#&gt;       X37       0.9215      Yes</span></span>
<span><span class="co">#&gt;       X38       1.0000       No</span></span>
<span><span class="co">#&gt;       X39       1.0000       No</span></span>
<span><span class="co">#&gt;       X40       1.0000       No</span></span>
<span><span class="co">#&gt;       X41       1.0000       No</span></span>
<span><span class="co">#&gt;       X42       0.6472      Yes</span></span>
<span><span class="co">#&gt;       X43       1.0000       No</span></span>
<span><span class="co">#&gt;       X44       1.0000       No</span></span>
<span><span class="co">#&gt;       X45       1.0000       No</span></span>
<span><span class="co">#&gt;       X46       1.0000       No</span></span>
<span><span class="co">#&gt;       X47       1.0000       No</span></span>
<span><span class="co">#&gt;       X48       1.0000       No</span></span>
<span><span class="co">#&gt;       X49       1.0000       No</span></span>
<span><span class="co">#&gt;       X50       1.0000       No</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  For transition '0--&gt;2': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio Selected</span></span>
<span><span class="co">#&gt;        X1       1.0000       No</span></span>
<span><span class="co">#&gt;        X2       1.9595      Yes</span></span>
<span><span class="co">#&gt;        X3       2.0326      Yes</span></span>
<span><span class="co">#&gt;        X4       1.0000       No</span></span>
<span><span class="co">#&gt;        X5       1.0000       No</span></span>
<span><span class="co">#&gt;        X6       1.0000       No</span></span>
<span><span class="co">#&gt;        X7       1.0000       No</span></span>
<span><span class="co">#&gt;        X8       1.0000       No</span></span>
<span><span class="co">#&gt;        X9       1.0000       No</span></span>
<span><span class="co">#&gt;       X10       1.0000       No</span></span>
<span><span class="co">#&gt;       X11       1.0000       No</span></span>
<span><span class="co">#&gt;       X12       1.0000       No</span></span>
<span><span class="co">#&gt;       X13       1.4770      Yes</span></span>
<span><span class="co">#&gt;       X14       1.0000       No</span></span>
<span><span class="co">#&gt;       X15       1.0000       No</span></span>
<span><span class="co">#&gt;       X16       1.0000       No</span></span>
<span><span class="co">#&gt;       X17       1.0000       No</span></span>
<span><span class="co">#&gt;       X18       1.0000       No</span></span>
<span><span class="co">#&gt;       X19       1.0000       No</span></span>
<span><span class="co">#&gt;       X20       1.0000       No</span></span>
<span><span class="co">#&gt;       X21       0.5205      Yes</span></span>
<span><span class="co">#&gt;       X22       0.6300      Yes</span></span>
<span><span class="co">#&gt;       X23       1.0000       No</span></span>
<span><span class="co">#&gt;       X24       1.0000       No</span></span>
<span><span class="co">#&gt;       X25       1.0000       No</span></span>
<span><span class="co">#&gt;       X26       1.0000       No</span></span>
<span><span class="co">#&gt;       X27       1.0294      Yes</span></span>
<span><span class="co">#&gt;       X28       1.0000       No</span></span>
<span><span class="co">#&gt;       X29       1.0000       No</span></span>
<span><span class="co">#&gt;       X30       1.0000       No</span></span>
<span><span class="co">#&gt;       X31       2.0563      Yes</span></span>
<span><span class="co">#&gt;       X32       2.0715      Yes</span></span>
<span><span class="co">#&gt;       X33       1.0000       No</span></span>
<span><span class="co">#&gt;       X34       0.9997      Yes</span></span>
<span><span class="co">#&gt;       X35       1.0000       No</span></span>
<span><span class="co">#&gt;       X36       1.0000       No</span></span>
<span><span class="co">#&gt;       X37       0.9934      Yes</span></span>
<span><span class="co">#&gt;       X38       1.0000       No</span></span>
<span><span class="co">#&gt;       X39       1.0000       No</span></span>
<span><span class="co">#&gt;       X40       1.0000       No</span></span>
<span><span class="co">#&gt;       X41       1.0000       No</span></span>
<span><span class="co">#&gt;       X42       1.5677      Yes</span></span>
<span><span class="co">#&gt;       X43       1.4706      Yes</span></span>
<span><span class="co">#&gt;       X44       1.0000       No</span></span>
<span><span class="co">#&gt;       X45       1.0000       No</span></span>
<span><span class="co">#&gt;       X46       1.0000       No</span></span>
<span><span class="co">#&gt;       X47       1.0000       No</span></span>
<span><span class="co">#&gt;       X48       1.0000       No</span></span>
<span><span class="co">#&gt;       X49       1.0000       No</span></span>
<span><span class="co">#&gt;       X50       1.0000       No</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  For transition '1--&gt;2': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio Selected</span></span>
<span><span class="co">#&gt;        X1       1.0000       No</span></span>
<span><span class="co">#&gt;        X2       1.6503      Yes</span></span>
<span><span class="co">#&gt;        X3       1.0000       No</span></span>
<span><span class="co">#&gt;        X4       1.0000       No</span></span>
<span><span class="co">#&gt;        X5       1.0000       No</span></span>
<span><span class="co">#&gt;        X6       1.0000       No</span></span>
<span><span class="co">#&gt;        X7       1.0000       No</span></span>
<span><span class="co">#&gt;        X8       1.0000       No</span></span>
<span><span class="co">#&gt;        X9       1.0000       No</span></span>
<span><span class="co">#&gt;       X10       1.0000       No</span></span>
<span><span class="co">#&gt;       X11       1.0000       No</span></span>
<span><span class="co">#&gt;       X12       0.6648      Yes</span></span>
<span><span class="co">#&gt;       X13       1.0000       No</span></span>
<span><span class="co">#&gt;       X14       0.9801      Yes</span></span>
<span><span class="co">#&gt;       X15       1.0000       No</span></span>
<span><span class="co">#&gt;       X16       1.0000       No</span></span>
<span><span class="co">#&gt;       X17       1.0000       No</span></span>
<span><span class="co">#&gt;       X18       1.0000       No</span></span>
<span><span class="co">#&gt;       X19       1.0000       No</span></span>
<span><span class="co">#&gt;       X20       1.0000       No</span></span>
<span><span class="co">#&gt;       X21       1.0000       No</span></span>
<span><span class="co">#&gt;       X22       0.7587      Yes</span></span>
<span><span class="co">#&gt;       X23       0.5750      Yes</span></span>
<span><span class="co">#&gt;       X24       1.0000       No</span></span>
<span><span class="co">#&gt;       X25       1.0000       No</span></span>
<span><span class="co">#&gt;       X26       1.0000       No</span></span>
<span><span class="co">#&gt;       X27       1.0000       No</span></span>
<span><span class="co">#&gt;       X28       1.0000       No</span></span>
<span><span class="co">#&gt;       X29       1.0000       No</span></span>
<span><span class="co">#&gt;       X30       1.0038      Yes</span></span>
<span><span class="co">#&gt;       X31       1.0000       No</span></span>
<span><span class="co">#&gt;       X32       1.8833      Yes</span></span>
<span><span class="co">#&gt;       X33       1.8642      Yes</span></span>
<span><span class="co">#&gt;       X34       1.0000       No</span></span>
<span><span class="co">#&gt;       X35       1.0000       No</span></span>
<span><span class="co">#&gt;       X36       1.0000       No</span></span>
<span><span class="co">#&gt;       X37       1.0000       No</span></span>
<span><span class="co">#&gt;       X38       1.0000       No</span></span>
<span><span class="co">#&gt;       X39       1.0000       No</span></span>
<span><span class="co">#&gt;       X40       1.0000       No</span></span>
<span><span class="co">#&gt;       X41       0.7038      Yes</span></span>
<span><span class="co">#&gt;       X42       0.7419      Yes</span></span>
<span><span class="co">#&gt;       X43       1.0000       No</span></span>
<span><span class="co">#&gt;       X44       1.0000       No</span></span>
<span><span class="co">#&gt;       X45       1.0000       No</span></span>
<span><span class="co">#&gt;       X46       1.0000       No</span></span>
<span><span class="co">#&gt;       X47       1.0000       No</span></span>
<span><span class="co">#&gt;       X48       1.0000       No</span></span>
<span><span class="co">#&gt;       X49       1.0000       No</span></span>
<span><span class="co">#&gt;       X50       1.0000       No</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10952.52</span></span>
<span><span class="va">modelexample</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; lambda01 lambda02 lambda12 </span></span>
<span><span class="co">#&gt; 36.84842 42.11105 31.58579</span></span>
<span></span>
<span></span>
<span><span class="va">coef01</span><span class="op">&lt;-</span><span class="va">modelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef01</span><span class="op">[</span><span class="va">coef01</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coef02</span><span class="op">&lt;-</span><span class="va">modelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">51</span><span class="op">:</span><span class="fl">100</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef02</span><span class="op">[</span><span class="va">coef02</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coef12</span><span class="op">&lt;-</span><span class="va">modelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">150</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef12</span><span class="op">[</span><span class="va">coef12</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Based on the variable selection made in Reg IDM-ICT, we can
re-estimate the model :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># formula on each transition</span></span>
<span>  <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = observed.lifetime, event = seen.exit) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">coef02</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(L,R), event = seen.ill) ~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">coef01</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">coef12</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#starting point</span></span>
<span>  <span class="va">start</span><span class="op">&lt;-</span><span class="va">modelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">start</span><span class="op">&lt;-</span><span class="va">start</span><span class="op">[</span><span class="va">start</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span></span>
<span>  <span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">theta01</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                                      <span class="va">modelexample</span><span class="op">$</span><span class="va">theta02</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                                      <span class="va">modelexample</span><span class="op">$</span><span class="va">theta12</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelexample</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span>,<span class="va">start</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#re-estimation</span></span>
<span>  <span class="va">remodelexample</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">simu</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                                eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="va">lambda02</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  </span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remodelexample</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">remodelexample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">remodelexample</span><span class="op">)</span></span>
<span><span class="co">#&gt; Method: M-splines based on likelihood </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  2000 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;1':  543 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;2 or 0--&gt;1--&gt;2':  1623 </span></span>
<span><span class="co">#&gt; number of covariates:  10 12 10 </span></span>
<span><span class="co">#&gt; observation deleted due to missing:  1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">remodelexample</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; HIDeM::idm(formula01 = f01, formula02 = f02, formula12 = f12, </span></span>
<span><span class="co">#&gt;     data = simu$data, method = "splines", maxiter = 100, eps = c(7, </span></span>
<span><span class="co">#&gt;         4, 2), B = start, lambda02 = lambda02)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Illness-death regression model using  M-spline approximations </span></span>
<span><span class="co">#&gt; to estimate the baseline transition intensities.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  2000 </span></span>
<span><span class="co">#&gt; number of events '0 -&gt; 1':  543 </span></span>
<span><span class="co">#&gt; number of events '0 -&gt; 2' or '0 -&gt; 1 -&gt; 2':  1623 </span></span>
<span><span class="co">#&gt; number of covariates:  10 12 10</span></span>
<span><span class="co">#&gt; Warning in print.idm(remodelexample): The model did not converge.</span></span>
<span><span class="co">#&gt; Warning: Maximum number of iterations reached.</span></span></code></pre></div>
<p>As we are in simulation setting we can evaluate its predicitive
abilities using : The predictive ability is evaluated by the Mean Square
Error on the probability for a healthy individual of becoming diseased
at a time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>u</mi><annotation encoding="application/x-tex">u</annotation></semantics></math>
between 0 and t,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mover><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><mo accent="true">̂</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mover><mi>F</mi><mo accent="true">̃</mo></mover><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> with </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>F</mi><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>t</mi></msubsup><msup><mi>e</mi><mrow><mi>−</mi><msub><mi>A</mi><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>A</mi><mn>02</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><msub><mi>α</mi><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>d</mi><mi>u</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\displaystyle{\widehat{MSEP}=\frac{1}{N}\sum_{i=1}^{N}(\widehat F_{01}(t_i) - \widetilde F_{01}(t_i))^2}
\mbox{ with }F_{01}(t)=\int_{0}^{t}e^{-A_{01}(u)-A_{02}(u)}\alpha_{01}(u)du,</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
is the number of individuals,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
the time of first event between the illness, the death illness-free and
the administrative censoring
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>=min{<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>T</mi><mn>01</mn></msup><mo>,</mo><msup><mi>T</mi><mn>02</mn></msup><mo>,</mo><mn>18</mn></mrow><annotation encoding="application/x-tex">T^{01},T^{02},18</annotation></semantics></math>}),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widehat F_{01}(t)</annotation></semantics></math>
the estimated probability by the fitted model and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̃</mo></mover><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widetilde F_{01}(t)</annotation></semantics></math>
the respective true probability modeled in the simulation.</p>
<p>We need to model a test replicate, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mrow><mi>M</mi><mi>S</mi><mi>E</mi><mi>P</mi></mrow><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\widehat{MSEP}</annotation></semantics></math>
is calculated by estimating the model with the variable selected in the
regularized approach on the corresponding data train replicate.</p>
<p>Firstly we simulate the test replicate using HIDeM::simulateIDM with
a different seed.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rep</span><span class="op">&lt;-</span><span class="fl">3</span></span>
<span><span class="va">datatest</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/simulateIDM.html">simulateIDM</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">2000</span>,seed<span class="op">=</span><span class="va">rep</span>,</span>
<span>                  scale.waittime<span class="op">=</span><span class="fl">0.07</span>,shape.waittime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  scale.lifetime<span class="op">=</span><span class="fl">0.085</span>,shape.lifetime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  scale.illtime<span class="op">=</span><span class="fl">0.075</span>,shape.illtime<span class="op">=</span><span class="fl">3.4</span>,</span>
<span>                  prob.censoring<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                  n.inspections<span class="op">=</span><span class="fl">8</span>,</span>
<span>                  administrative.censoring <span class="op">=</span> <span class="fl">18</span>,</span>
<span>                  schedule<span class="op">=</span><span class="fl">2.5</span>,punctuality<span class="op">=</span><span class="fl">0.5</span>,nvar<span class="op">=</span><span class="va">n_var</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n_var</span><span class="op">)</span>,cov<span class="op">=</span><span class="va">cov</span>,</span>
<span>                  x01<span class="op">=</span><span class="va">id01</span>,x02<span class="op">=</span><span class="va">id02</span>,x12<span class="op">=</span><span class="va">id12</span>,</span>
<span>                  beta01<span class="op">=</span><span class="va">BETA01</span><span class="op">[</span><span class="va">BETA01</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>,beta02<span class="op">=</span><span class="va">BETA02</span><span class="op">[</span><span class="va">BETA02</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span>,</span>
<span>                  beta12<span class="op">=</span><span class="va">BETA12</span><span class="op">[</span><span class="va">BETA12</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Following using HIDeM::intensity and pracma::gauss_kronrod we can
calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>01</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widehat F_{01}(t)</annotation></semantics></math>
for all individuals :</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datatest</span><span class="op">&lt;-</span><span class="va">datatest</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">F01</span><span class="op">&lt;-</span><span class="va">trueF01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">2000</span><span class="op">)</span></span>
<span><span class="va">time</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">$</span><span class="va">T01</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">datatest</span><span class="op">$</span><span class="va">T02</span><span class="op">[</span><span class="va">x</span><span class="op">]</span>,<span class="va">datatest</span><span class="op">$</span><span class="va">administrative.censoring</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span></span>
<span>   <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">modelPar</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.4</span>,<span class="fl">0.075</span>,<span class="fl">3.4</span>,<span class="fl">0.085</span>,<span class="fl">3.4</span>,<span class="fl">0.07</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pracma</span><span class="op">)</span></span>
<span></span>
<span> <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2000</span><span class="op">)</span><span class="op">{</span></span>
<span>   </span>
<span>   <span class="co"># as time = 0 we have denum = 1 but in  other cases you can calculate</span></span>
<span>   <span class="co"># the left truncation using the following code of denum </span></span>
<span>   </span>
<span>  <span class="va">beta01</span><span class="op">&lt;-</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">NC</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">b01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">remodelexample</span><span class="op">$</span><span class="va">Xnames01</span><span class="op">]</span><span class="op">*</span><span class="va">beta01</span><span class="op">)</span></span>
<span>  <span class="va">b01true</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="va">BETA01</span><span class="op">)</span></span>
<span>  </span>
<span>      <span class="va">denum</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="fl">0</span>,</span>
<span>                       knots<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">knots01</span>,</span>
<span>                       theta<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">theta01</span>,</span>
<span>                       linear.predictor <span class="op">=</span> <span class="va">b01</span>,</span>
<span>                       number.knots <span class="op">=</span> <span class="va">remodelexample</span><span class="op">$</span><span class="va">nknots01</span>,</span>
<span>                       method<span class="op">=</span><span class="st">"splines"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span>      </span>
<span>  <span class="va">beta02</span><span class="op">&lt;-</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="op">(</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">NC</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">NC</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">NC</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">b02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">remodelexample</span><span class="op">$</span><span class="va">Xnames02</span><span class="op">]</span><span class="op">*</span><span class="va">beta02</span><span class="op">)</span></span>
<span>  <span class="va">b02true</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">[</span><span class="va">i</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">datatest</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">*</span><span class="va">BETA02</span><span class="op">)</span></span>
<span>  </span>
<span>      <span class="va">denum</span><span class="op">&lt;-</span><span class="va">denum</span><span class="op">*</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="fl">0</span>,</span>
<span>                             knots<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">knots02</span>,</span>
<span>                             theta<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">theta02</span>,</span>
<span>                             number.knots <span class="op">=</span> <span class="va">remodelexample</span><span class="op">$</span><span class="va">nknots02</span>,</span>
<span>                             linear.predictor <span class="op">=</span> <span class="va">b02</span>,</span>
<span>                             method<span class="op">=</span><span class="st">"splines"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span></span>
<span>    </span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">time</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">num</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pracma/man/gauss_kronrod.html" class="external-link">gauss_kronrod</a></span><span class="op">(</span>f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                       knots<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">knots01</span>,</span>
<span>                       theta<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">theta01</span>,</span>
<span>                       linear.predictor <span class="op">=</span> <span class="va">b01</span>,</span>
<span>                       number.knots <span class="op">=</span> <span class="va">remodelexample</span><span class="op">$</span><span class="va">nknots01</span>,</span>
<span>                       method<span class="op">=</span><span class="st">"splines"</span><span class="op">)</span><span class="op">$</span><span class="va">intensity</span></span>
<span>        </span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">*</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                           knots<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">knots01</span>,</span>
<span>                           theta<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">theta01</span>,</span>
<span>                           linear.predictor <span class="op">=</span> <span class="va">b01</span>,</span>
<span>                           number.knots <span class="op">=</span> <span class="va">remodelexample</span><span class="op">$</span><span class="va">nknots01</span>,</span>
<span>                           method<span class="op">=</span><span class="st">"splines"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">*</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                           knots<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">knots02</span>,</span>
<span>                           theta<span class="op">=</span><span class="va">remodelexample</span><span class="op">$</span><span class="va">theta02</span>,</span>
<span>                           number.knots <span class="op">=</span> <span class="va">remodelexample</span><span class="op">$</span><span class="va">nknots02</span>,</span>
<span>                           linear.predictor <span class="op">=</span> <span class="va">b02</span>,</span>
<span>                           method<span class="op">=</span><span class="st">"splines"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span>        </span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>      <span class="op">}</span>,a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="va">time</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>      </span>
<span>      <span class="va">truenum</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/pracma/man/gauss_kronrod.html" class="external-link">gauss_kronrod</a></span><span class="op">(</span>f<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                       theta<span class="op">=</span><span class="va">modelPar</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                       linear.predictor <span class="op">=</span> <span class="va">b01true</span>,</span>
<span>                       method<span class="op">=</span><span class="st">"weib"</span><span class="op">)</span><span class="op">$</span><span class="va">intensity</span></span>
<span>        </span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">*</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                           theta<span class="op">=</span><span class="va">modelPar</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                           linear.predictor <span class="op">=</span> <span class="va">b01true</span>,</span>
<span>                           method<span class="op">=</span><span class="st">"weib"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span>        <span class="va">res</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">*</span><span class="fu"><a href="../reference/intensity.html">intensity</a></span><span class="op">(</span>times<span class="op">=</span><span class="va">x</span>,</span>
<span>                           theta<span class="op">=</span><span class="va">modelPar</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>                           linear.predictor <span class="op">=</span> <span class="va">b02true</span>,</span>
<span>                           method<span class="op">=</span><span class="st">"weib"</span><span class="op">)</span><span class="op">$</span><span class="va">survival</span></span>
<span>        </span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span>      <span class="op">}</span>,a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="va">time</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">value</span></span>
<span>      <span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="va">num</span><span class="op">&lt;-</span><span class="fl">0</span><span class="op">}</span></span>
<span>      </span>
<span>      <span class="va">F01</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="op">(</span><span class="va">num</span><span class="op">/</span><span class="va">denum</span><span class="op">)</span></span>
<span>      <span class="va">trueF01</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">truenum</span></span>
<span>      </span>
<span> <span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">F01</span><span class="op">-</span><span class="va">trueF01</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2000</span></span>
<span><span class="co">#&gt; [1] 0.00183851</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ariane Bercu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
