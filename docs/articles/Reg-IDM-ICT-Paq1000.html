<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reg-IDM-ICT-Paq1000 â€¢ HIDeM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Reg-IDM-ICT-Paq1000">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HIDeM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Reg-IDM-ICT-example.html">Reg-IDM-ICT-example</a>
    </li>
    <li>
      <a href="../articles/Reg-IDM-ICT-Paq1000.html">Reg-IDM-ICT-Paq1000</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Reg-IDM-ICT-Paq1000</h1>
            
      

      <div class="hidden name"><code>Reg-IDM-ICT-Paq1000.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="load-hidem-and-paq1000-data-set">Load HIDeM and Paq1000 data set<a class="anchor" aria-label="anchor" href="#load-hidem-and-paq1000-data-set"></a>
</h2>
<p>The Paquid data set composed of 1000 subjects selected randomly from
the Paquid data set of 3675 subjects. We have one row per individual
observation and the following 8 columns :</p>
<ul>
<li>dementia for dementia status, 0=non-demented, 1=demented</li>
<li>death for death status, 0=alive, 1=dead</li>
<li>e, the age at entry in the study</li>
<li>l : age at the last visit before the diagnostic of dementia or age
at last visit for non-demented subjects</li>
<li>r : age at the diagnostic visit for demented subject or age at the
last visit for non-demented subjects</li>
<li>t : age at death or age at the latest news for alive subject</li>
<li>certif : primary school certificate, 0=without certificate, 1=with
certificate</li>
<li>gender: 0=female, 1=male</li>
</ul>
<p>In addition, we had fifty noise variable noted Z, following an
independent Gaussian distribution (centered and reduced).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">HIDeM</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: prodlim</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ddsjoberg/gtsummary" class="external-link">gtsummary</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gtsummary'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="co"># Load the data (assuming it's a space-separated or tab-delimited file)</span></span>
<span><span class="va">Paq1000</span> <span class="op">&lt;-</span> <span class="fu">HIDeM</span><span class="fu">::</span><span class="va">Paq1000</span></span>
<span></span>
<span><span class="va">summaries</span><span class="op">&lt;-</span><span class="va">Paq1000</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dementia <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">dementia</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Demented"</span>,<span class="st">"Healthy"</span><span class="op">)</span>,</span>
<span>          death<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">death</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"Death"</span>,<span class="st">"Alive"</span><span class="op">)</span>,</span>
<span>          certif<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">certif</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"with certificate"</span>,<span class="st">"without certificate"</span><span class="op">)</span>,</span>
<span>          gender<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">gender</span><span class="op">==</span><span class="fl">0</span>,<span class="st">"female"</span>,<span class="st">"male"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_strata.html" class="external-link">tbl_strata</a></span><span class="op">(</span></span>
<span>     strata <span class="op">=</span> <span class="va">dementia</span>,</span>
<span>     .tbl_fun <span class="op">=</span></span>
<span>       <span class="op">~</span> <span class="va">.x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>       <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/tbl_summary.html" class="external-link">tbl_summary</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">death</span>,</span>
<span>                   type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">~</span> <span class="st">"continuous2"</span><span class="op">)</span>,</span>
<span>                   statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                     <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_categorical</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="st">"{n} ({p}%)"</span></span>
<span>                   <span class="op">)</span>,</span>
<span>                   digits <span class="op">=</span> <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/select_helpers.html" class="external-link">all_continuous</a></span><span class="op">(</span><span class="op">)</span> <span class="op">~</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>     .header <span class="op">=</span> <span class="st">"**{strata}**, N = {n}"</span></span>
<span>   <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://www.danieldsjoberg.com/gtsummary/reference/modify_caption.html" class="external-link">modify_caption</a></span><span class="op">(</span><span class="st">"Characteristics of individuals in Paq1000 dataset"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summaries</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<caption><span class="gt_from_md">Characteristics of individuals in Paq1000 dataset</span></caption>
  <thead>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="label"><span class="gt_from_md"><strong>Characteristic</strong></span></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="level 1; stat_1_1">
        <div class="gt_column_spanner"><span class="gt_from_md"><strong>Demented</strong>, N = 186</span></div>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="level 1; stat_1_2">
        <div class="gt_column_spanner"><span class="gt_from_md"><strong>Healthy</strong>, N = 814</span></div>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_1">
<span class="gt_from_md"><strong>Alive</strong><br>
N = 59</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_1">
<span class="gt_from_md"><strong>Death</strong><br>
N = 127</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_1_2">
<span class="gt_from_md"><strong>Alive</strong><br>
N = 217</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="stat_2_2">
<span class="gt_from_md"><strong>Death</strong><br>
N = 597</span><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span>
</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="label" class="gt_row gt_left">e</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">70.25 (67.33, 74.58)</td>
<td headers="stat_2_1" class="gt_row gt_center">76.25 (71.83, 80.75)</td>
<td headers="stat_1_2" class="gt_row gt_center">68.92 (67.42, 72.92)</td>
<td headers="stat_2_2" class="gt_row gt_center">76.42 (71.00, 81.75)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">l</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">81.88 (78.32, 84.89)</td>
<td headers="stat_2_1" class="gt_row gt_center">81.58 (77.42, 85.05)</td>
<td headers="stat_1_2" class="gt_row gt_center">84.50 (77.47, 87.42)</td>
<td headers="stat_2_2" class="gt_row gt_center">81.40 (76.03, 86.24)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">r</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">85.34 (82.71, 88.20)</td>
<td headers="stat_2_1" class="gt_row gt_center">84.73 (80.52, 88.23)</td>
<td headers="stat_1_2" class="gt_row gt_center">84.50 (77.47, 87.42)</td>
<td headers="stat_2_2" class="gt_row gt_center">81.40 (76.03, 86.24)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">t</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â Median (Q1, Q3)</td>
<td headers="stat_1_1" class="gt_row gt_center">87.42 (84.51, 92.36)</td>
<td headers="stat_2_1" class="gt_row gt_center">88.18 (83.34, 91.46)</td>
<td headers="stat_1_2" class="gt_row gt_center">86.37 (84.68, 90.32)</td>
<td headers="stat_2_2" class="gt_row gt_center">84.70 (80.01, 89.74)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">certif</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â with certificate</td>
<td headers="stat_1_1" class="gt_row gt_center">13 (22%)</td>
<td headers="stat_2_1" class="gt_row gt_center">19 (15%)</td>
<td headers="stat_1_2" class="gt_row gt_center">63 (29%)</td>
<td headers="stat_2_2" class="gt_row gt_center">143 (24%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â without certificate</td>
<td headers="stat_1_1" class="gt_row gt_center">46 (78%)</td>
<td headers="stat_2_1" class="gt_row gt_center">108 (85%)</td>
<td headers="stat_1_2" class="gt_row gt_center">154 (71%)</td>
<td headers="stat_2_2" class="gt_row gt_center">454 (76%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">gender</td>
<td headers="stat_1_1" class="gt_row gt_center"><br></td>
<td headers="stat_2_1" class="gt_row gt_center"><br></td>
<td headers="stat_1_2" class="gt_row gt_center"><br></td>
<td headers="stat_2_2" class="gt_row gt_center"><br></td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â female</td>
<td headers="stat_1_1" class="gt_row gt_center">44 (75%)</td>
<td headers="stat_2_1" class="gt_row gt_center">82 (65%)</td>
<td headers="stat_1_2" class="gt_row gt_center">135 (62%)</td>
<td headers="stat_2_2" class="gt_row gt_center">317 (53%)</td>
</tr>
<tr>
<td headers="label" class="gt_row gt_left">Â Â Â Â male</td>
<td headers="stat_1_1" class="gt_row gt_center">15 (25%)</td>
<td headers="stat_2_1" class="gt_row gt_center">45 (35%)</td>
<td headers="stat_1_2" class="gt_row gt_center">82 (38%)</td>
<td headers="stat_2_2" class="gt_row gt_center">280 (47%)</td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr>
<td class="gt_footnote" colspan="5">
<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> <span class="gt_from_md">n (%)</span>
</td>
    </tr></tfoot>
</table>
</div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Z</span><span class="op">&lt;-</span><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Paq1000</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Paq1000</span>,<span class="va">Z</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-idm-ict">Run IDM-ICT<a class="anchor" aria-label="anchor" href="#run-idm-ict"></a>
</h2>
<p>In this section, we will explicit the profile likelihood, with an</p>
<ul>
<li>outer loop on penalty parameters noted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>Î»</mi><mn>01</mn></msub><mo>,</mo><msub><mi>Î»</mi><mn>02</mn></msub><mo>,</mo><msub><mi>Î»</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,\lambda_{01},\lambda_{02},\lambda_{12})</annotation></semantics></math>,
and</li>
<li>an inner loop on regression parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î²</mi><mn>01</mn></msub><mo>,</mo><msub><mi>Î²</mi><mn>02</mn></msub><mo>,</mo><msub><mi>Î²</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\beta_{01},\beta_{02},\beta_{12})</annotation></semantics></math>
and baseline intensity parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î¸</mi><mn>01</mn></msub><mo>,</mo><msub><mi>Î¸</mi><mn>02</mn></msub><mo>,</mo><msub><mi>Î¸</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\theta_{01},\theta_{02},\theta_{12})</annotation></semantics></math>
</li>
</ul>
<p>Firstly, we need to perform a pre-selection of penalty parameters for
each transition separately. For each transition, we first fit
multi-state models including covariates only in the transition from
state
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>,
and considering a grid of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î»</mi><mrow><mi>h</mi><mi>l</mi></mrow></msub><annotation encoding="application/x-tex">\lambda_{hl}</annotation></semantics></math>
with equidistant values from 0.0001 and 100 while keeping
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
fixed at 1. It is recommended to try multiple values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="postfix">]</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">]0,1]</annotation></semantics></math>,
but for this example we will limit to lasso penalty (a=1).</p>
<p>We choose to estimate the baseline intensity transition with M-spline
basis with nodes at 65, 84 and 103 years old. To initiative, baseline
intensities parameters of M-splines, we run a model without
covariates.</p>
<ol style="list-style-type: decimal">
<li>Choose baseline intensity parametrization based on void model</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">mvoidPaq1000</span> <span class="op">&lt;-</span>  <span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">t</span>,event<span class="op">=</span><span class="va">death</span>,entry<span class="op">=</span><span class="va">e</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula01<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">l</span>,<span class="va">r</span><span class="op">)</span>,event<span class="op">=</span><span class="va">dementia</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula12<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                        data<span class="op">=</span><span class="va">Paq1000</span>,maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mvoidquant</span> <span class="op">&lt;-</span>  <span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">t</span>,event<span class="op">=</span><span class="va">death</span>,entry<span class="op">=</span><span class="va">e</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula01<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">l</span>,<span class="va">r</span><span class="op">)</span>,event<span class="op">=</span><span class="va">dementia</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula12<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        method<span class="op">=</span><span class="st">"splines"</span>,n.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span>,knots<span class="op">=</span><span class="st">"quantile"</span>,</span>
<span>                     type.quantile<span class="op">=</span><span class="fl">1</span>,</span>
<span>                        data<span class="op">=</span><span class="va">Paq1000</span>,maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoid</span><span class="op">$</span><span class="va">loglik</span> </span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoidquant</span><span class="op">$</span><span class="va">loglik</span> </span>
<span></span>
<span><span class="va">mvoidn4</span> <span class="op">&lt;-</span>  <span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">t</span>,event<span class="op">=</span><span class="va">death</span>,entry<span class="op">=</span><span class="va">e</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula01<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">l</span>,<span class="va">r</span><span class="op">)</span>,event<span class="op">=</span><span class="va">dementia</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula12<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        method<span class="op">=</span><span class="st">"splines"</span>,n.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,</span>
<span>                        data<span class="op">=</span><span class="va">Paq1000</span>,maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mvoidquantn4</span> <span class="op">&lt;-</span>  <span class="fu">HIDeM</span><span class="fu">::</span><span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">t</span>,event<span class="op">=</span><span class="va">death</span>,entry<span class="op">=</span><span class="va">e</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula01<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/prodlim/man/Hist.html" class="external-link">Hist</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">l</span>,<span class="va">r</span><span class="op">)</span>,event<span class="op">=</span><span class="va">dementia</span><span class="op">)</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        formula12<span class="op">=</span><span class="op">~</span><span class="fl">1</span>,</span>
<span>                        method<span class="op">=</span><span class="st">"splines"</span>,n.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">4</span><span class="op">)</span>,knots<span class="op">=</span><span class="st">"quantile"</span>,</span>
<span>                     type.quantile<span class="op">=</span><span class="fl">1</span>,</span>
<span>                        data<span class="op">=</span><span class="va">Paq1000</span>,maxiter<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoid</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoidn4</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoidquant</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fl">3</span><span class="op">*</span><span class="fl">5</span></span>
<span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">mvoidquantn4</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fl">3</span><span class="op">*</span><span class="fl">6</span></span>
<span></span>
<span><span class="co"># best to keep 5 parameters per transition using equidistant points</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Estimation of Reg IDM-ICT transition specific model</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta01</span>,<span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta02</span>,<span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta12</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">52</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">nlambda</span><span class="op">&lt;-</span><span class="fl">20</span></span>
<span>  <span class="va">lambdatest</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">100</span>,length.out<span class="op">=</span><span class="va">nlambda</span><span class="op">)</span></span>
<span>  <span class="va">penalty</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">a</span><span class="op">==</span><span class="fl">1</span>,<span class="st">"lasso"</span>,<span class="st">"elasticnet"</span><span class="op">)</span></span>
<span></span>
<span>  </span>
<span><span class="co">############################ 01 ################################################</span></span>
<span>    <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = t, event =death,entry=e) ~1"</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event = dementia) ~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"~1"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">m01Paq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                    formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                    formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">Paq1000</span>,</span>
<span>                                    penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                    lambda01 <span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                    lambda02<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span>                                    lambda12<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span><span class="co">################################ 02 ############################################</span></span>
<span></span>
<span>  <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = t, event = death,entry=e) ~ certif + gender + "</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event = dementia) ~ 1"</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"~1"</span><span class="op">)</span></span>
<span><span class="co">#setwd("C:/Users/ab17/Desktop/CURTA/SMOOTH_HAZARD/OPTIM_B_DIFFLAMBDA_derivaana_all/Weibull_simu/Scenario1")</span></span>
<span></span>
<span>  <span class="va">m02Paq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                    formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                    formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">Paq1000</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                    lambda02 <span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                    lambda01<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span>                                    lambda12<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span></span>
<span><span class="co">######################################## 12 ###################################</span></span>
<span></span>
<span>  <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = t, event = death,entry=e) ~1"</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event =dementia) ~ 1"</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~ certif + gender + "</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">m12Paq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">Paq1000</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda01 <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>                                lambda12<span class="op">=</span> <span class="va">lambdatest</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="fl">0.0001</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  </span></code></pre></div>
<p>The ouput of each models can be displayed using standard function
such as print and summary :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">m01Paq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m01Paq1000</span></span>
<span><span class="va">m02Paq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m02Paq1000</span></span>
<span><span class="va">m12Paq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">m12Paq1000</span></span>
<span></span>
<span><span class="co">#print(m01Paq1000)</span></span>
<span><span class="co">#summary(m01Paq1000)</span></span>
<span></span>
<span><span class="co">#print(m02Paq1000)</span></span>
<span><span class="co">#summary(m02Paq1000)</span></span>
<span></span>
<span><span class="co">#print(m12Paq1000)</span></span>
<span><span class="co">#summary(m12Paq1000)</span></span></code></pre></div>
<p>The following step is to visualize the Bayesian Indicator Criteria
(BIC) and determine the 3 values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
per transition minimizing it :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span>,<span class="va">m01Paq1000</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 0 -&gt; 1"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,<span class="va">m02Paq1000</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 0 -&gt; 2"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-5-2.png" width="576"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>,<span class="va">m12Paq1000</span><span class="op">$</span><span class="va">BIC</span>,xlab<span class="op">=</span><span class="st">"Lambda values for 1 -&gt; 2"</span>,ylab<span class="op">=</span><span class="st">"BIC"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-5-3.png" width="576"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lambda01</span><span class="op">&lt;-</span><span class="va">lambda02</span><span class="op">&lt;-</span><span class="va">lambda12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">############################## 01 ##############################################</span></span>
<span><span class="va">BIC01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC01</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC01</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda01</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m01Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda01</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="co">############################## 02 ##############################################</span></span>
<span><span class="va">BIC02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC02</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC02</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda02</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda02</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m02Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda02</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="co">############################## 12 ##############################################</span></span>
<span><span class="va">BIC12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">[</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">converged</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">BIC12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">BIC12</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span><span class="va">BIC12</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">lambda</span><span class="op">&lt;-</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="va">id</span><span class="op">]</span></span>
<span>    <span class="va">lambda12</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    </span>
<span>      <span class="va">lambda12</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">m12Paq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="va">id</span><span class="op">]</span></span>
<span>      <span class="va">lambda12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">lambda12</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="va">lambda01</span></span>
<span><span class="co">#&gt; [1] 36.84842 42.11105 47.37368</span></span>
<span><span class="va">lambda02</span></span>
<span><span class="co">#&gt; [1] 42.11105 47.37368 52.63632</span></span>
<span><span class="va">lambda12</span></span>
<span><span class="co">#&gt; [1] 31.58579 36.84842 42.11105</span></span></code></pre></div>
<p>Note that for each transition, we reached the minimum as we have this
U-shape of BIC values along
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>.
Once we have determined each value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
we have 27 combinations of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î»</mi><mn>01</mn></msub><annotation encoding="application/x-tex">\lambda_{01}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î»</mi><mn>02</mn></msub><annotation encoding="application/x-tex">\lambda_{02}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î»</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\lambda_{12}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a=1</annotation></semantics></math>,
leading to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>108</mn><annotation encoding="application/x-tex">108</annotation></semantics></math>
combinations in total. Now, we can estimate the full model and
ultimately select the combination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><msub><mi>Î»</mi><mn>01</mn></msub><mo>,</mo><msub><mi>Î»</mi><mn>02</mn></msub><mo>,</mo><msub><mi>Î»</mi><mn>12</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a,\lambda_{01},\lambda_{02},\lambda_{12})</annotation></semantics></math>
that minimizes the BIC.</p>
<ol start="3" style="list-style-type: decimal">
<li>Estimate Reg IDM-ICT with variable selection on all transitions</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>   <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = t, event = death,entry=e) ~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event = dementia) ~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">modelPaq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">Paq1000</span>,</span>
<span>                                penalty<span class="op">=</span><span class="va">penalty</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda01 <span class="op">=</span> <span class="va">lambda01</span>,</span>
<span>                                lambda12<span class="op">=</span> <span class="va">lambda12</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="va">lambda02</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">52</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                alpha<span class="op">=</span><span class="va">k</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  </span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">modelPaq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">modelPaq1000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Method: M-splines based on likelihood </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  1000 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;1':  186 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;2 or 0--&gt;1--&gt;2':  724 </span></span>
<span><span class="co">#&gt; number of covariates:  52 52 52 </span></span>
<span><span class="co">#&gt; type of penalty:  lasso </span></span>
<span><span class="co">#&gt; range of lambda value '0--&gt;1':  36.84842 ; 47.37368 </span></span>
<span><span class="co">#&gt; range of lambda value '0--&gt;2':  42.11105 ; 52.63632 </span></span>
<span><span class="co">#&gt; range of lambda value '1--&gt;2':  31.58579 ; 42.11105 </span></span>
<span><span class="co">#&gt; observation deleted due to missing:  1 </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Minimum BIC with convergence : BIC= 6111.739  </span></span>
<span><span class="co">#&gt;  with lambda ( 36.84842 42.11105 47.37368 36.84842 42.11105 47.37368 ; 42.11105 42.11105 42.11105 42.11105 42.11105 42.11105 ; 36.84842 36.84842 36.84842 42.11105 42.11105 42.11105 ) and alpha = 1 1 1 1 1 1 </span></span>
<span><span class="co">#&gt; For transition '0--&gt;1': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio.1 Hazard_ratio.2 Hazard_ratio.3 Hazard_ratio.4</span></span>
<span><span class="co">#&gt;    certif              1              1              1              1</span></span>
<span><span class="co">#&gt;    gender              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z1              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z2              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z3              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z4              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z5              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z6              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z7              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z8              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z9              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z10              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z11              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z12              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z13              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z14              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z15              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z16              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z17              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z18              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z19              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z20              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z21              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z22              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z23              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z24              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z25              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z26              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z27              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z28              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z29              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z30              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z31              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z32              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z33              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z34              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z35              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z36              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z37              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z38              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z39              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z40              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z41              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z42              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z43              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z44              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z45              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z46              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z47              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z48              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z49              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z50              1              1              1              1</span></span>
<span><span class="co">#&gt;  Hazard_ratio.5 Hazard_ratio.6 Selected.1 Selected.2 Selected.3 Selected.4</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;  Selected.5 Selected.6</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  For transition '0--&gt;2': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio.1 Hazard_ratio.2 Hazard_ratio.3 Hazard_ratio.4</span></span>
<span><span class="co">#&gt;    certif         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;    gender         1.1937         1.1937         1.1937         1.1937</span></span>
<span><span class="co">#&gt;        Z1         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z2         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z3         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z4         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z5         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z6         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z7         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z8         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;        Z9         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z10         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z11         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z12         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z13         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z14         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z15         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z16         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z17         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z18         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z19         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z20         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z21         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z22         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z23         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z24         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z25         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z26         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z27         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z28         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z29         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z30         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z31         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z32         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z33         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z34         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z35         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z36         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z37         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z38         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z39         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z40         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z41         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z42         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z43         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z44         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z45         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z46         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z47         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z48         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z49         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;       Z50         1.0000         1.0000         1.0000         1.0000</span></span>
<span><span class="co">#&gt;  Hazard_ratio.5 Hazard_ratio.6 Selected.1 Selected.2 Selected.3 Selected.4</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.1937         1.1937        Yes        Yes        Yes        Yes</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;          1.0000         1.0000         No         No         No         No</span></span>
<span><span class="co">#&gt;  Selected.5 Selected.6</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;         Yes        Yes</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  For transition '1--&gt;2': </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  Variable Hazard_ratio.1 Hazard_ratio.2 Hazard_ratio.3 Hazard_ratio.4</span></span>
<span><span class="co">#&gt;    certif              1              1              1              1</span></span>
<span><span class="co">#&gt;    gender              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z1              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z2              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z3              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z4              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z5              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z6              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z7              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z8              1              1              1              1</span></span>
<span><span class="co">#&gt;        Z9              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z10              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z11              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z12              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z13              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z14              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z15              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z16              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z17              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z18              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z19              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z20              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z21              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z22              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z23              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z24              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z25              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z26              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z27              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z28              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z29              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z30              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z31              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z32              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z33              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z34              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z35              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z36              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z37              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z38              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z39              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z40              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z41              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z42              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z43              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z44              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z45              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z46              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z47              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z48              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z49              1              1              1              1</span></span>
<span><span class="co">#&gt;       Z50              1              1              1              1</span></span>
<span><span class="co">#&gt;  Hazard_ratio.5 Hazard_ratio.6 Selected.1 Selected.2 Selected.3 Selected.4</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;               1              1         No         No         No         No</span></span>
<span><span class="co">#&gt;  Selected.5 Selected.6</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span><span class="co">#&gt;          No         No</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6111.739</span></span>
<span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; lambda01 lambda02 lambda12 </span></span>
<span><span class="co">#&gt; 36.84842 42.11105 36.84842</span></span>
<span></span>
<span><span class="co"># no variable on 0 --&gt; 1</span></span>
<span><span class="va">coef01</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">52</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef01</span><span class="op">[</span><span class="va">coef01</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># gender on 0 --&gt; 2 </span></span>
<span><span class="va">coef02</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">53</span><span class="op">:</span><span class="fl">104</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef02</span><span class="op">[</span><span class="va">coef02</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># no variable on 1 --&gt;2</span></span>
<span><span class="va">coef12</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">105</span><span class="op">:</span><span class="fl">156</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">coef12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">coef12</span><span class="op">[</span><span class="va">coef12</span><span class="op">!=</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Estimate covariate effects</li>
</ol>
<p>Based on the variable selection made in Reg IDM-ICT, we can
re-estimate the model :</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>   <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = t, event = death,entry=e) ~ gender"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event = dementia) ~ 1"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~ 1"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">remodelPaq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">Paq1000</span>,</span>
<span>                                eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="va">lambda02</span>,B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta01</span>,</span>
<span>                                                      <span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta02</span>,</span>
<span>                                                      <span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta12</span>,<span class="fl">0</span><span class="op">)</span>,</span>
<span>                                maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  </span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">remodelPaq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">remodelPaq1000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">remodelPaq1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Method: M-splines based on likelihood </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  1000 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;1':  186 </span></span>
<span><span class="co">#&gt; number of events '0--&gt;2 or 0--&gt;1--&gt;2':  724 </span></span>
<span><span class="co">#&gt; number of covariates:  0 1 0 </span></span>
<span><span class="co">#&gt; observation deleted due to missing:  1 </span></span>
<span><span class="co">#&gt;           Hazard.ratio Standard.error       CI.95 P.value</span></span>
<span><span class="co">#&gt; gender_02       1.8085         0.1081 [1.46;2.24] &lt; 1e-04</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">remodelPaq1000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; HIDeM::idm(formula01 = f01, formula02 = f02, formula12 = f12, </span></span>
<span><span class="co">#&gt;     data = Paq1000, method = "splines", maxiter = 100, maxiter.pena = 2, </span></span>
<span><span class="co">#&gt;     eps = c(7, 4, 2), B = c(mvoid$theta01, mvoid$theta02, mvoid$theta12, </span></span>
<span><span class="co">#&gt;         0), lambda02 = lambda02)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Illness-death regression model using  M-spline approximations </span></span>
<span><span class="co">#&gt; to estimate the baseline transition intensities.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; number of subjects:  1000 </span></span>
<span><span class="co">#&gt; number of events '0 -&gt; 1':  186 </span></span>
<span><span class="co">#&gt; number of events '0 -&gt; 2' or '0 -&gt; 1 -&gt; 2':  724 </span></span>
<span><span class="co">#&gt; number of covariates:  0 1 0 </span></span>
<span><span class="co">#&gt; The model did converge. </span></span>
<span><span class="co">#&gt; Log-likelihood :  -3050.002 </span></span>
<span><span class="co">#&gt; ----</span></span>
<span><span class="co">#&gt; Model converged.</span></span>
<span><span class="co">#&gt; number of iterations:  50 </span></span>
<span><span class="co">#&gt; convergence criteria: parameters= 2.6e-09 </span></span>
<span><span class="co">#&gt;                     : likelihood= 2.6e-07 </span></span>
<span><span class="co">#&gt;                     : second derivatives= 2.8e-08 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Splines parameters:</span></span>
<span><span class="co">#&gt;       transition01 transition02 transition12</span></span>
<span><span class="co">#&gt; knots            3            3            3</span></span></code></pre></div>
<p>To evaluate the stability of the variable selection for given penalty
parameters, we can perform boostrap on individuals. As an illustration
we will perform it on 50 samples,</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mvoidPaq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">mvoidPaq1000</span></span>
<span><span class="va">start</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta01</span>,<span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta02</span>,<span class="va">mvoidPaq1000</span><span class="op">$</span><span class="va">theta12</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">52</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lambda01</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">lambda02</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">lambda12</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">lambda</span><span class="op">[</span><span class="fl">3</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">bootmodel</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">bootmodel</span><span class="op">)</span><span class="op">&lt;-</span><span class="fl">50</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>  <span class="va">id</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Paq1000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Paq1000</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,replace<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">boot</span><span class="op">&lt;-</span><span class="va">Paq1000</span><span class="op">[</span><span class="va">id</span>,<span class="op">]</span></span>
<span>  </span>
<span>  </span>
<span>     <span class="va">f02</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = t, event = death,entry=e) ~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f01</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hist(time = list(l,r), event = dementia) ~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f12</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"~ certif + gender +"</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,collapse<span class="op">=</span><span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">modelPaq1000</span> <span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span>  <span class="fu"><a href="../reference/idm.html">idm</a></span><span class="op">(</span>formula02 <span class="op">=</span> <span class="va">f02</span>,</span>
<span>                                formula01 <span class="op">=</span> <span class="va">f01</span>,</span>
<span>                                formula12 <span class="op">=</span> <span class="va">f12</span>,data<span class="op">=</span><span class="va">boot</span>,</span>
<span>                                penalty<span class="op">=</span><span class="st">"lasso"</span>,eps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span>,</span>
<span>                                method<span class="op">=</span><span class="st">"splines"</span>,</span>
<span>                                lambda01 <span class="op">=</span> <span class="va">lambda01</span>,</span>
<span>                                lambda12<span class="op">=</span> <span class="va">lambda12</span>,</span>
<span>                                lambda02<span class="op">=</span><span class="va">lambda02</span>,B<span class="op">=</span><span class="va">start</span>,</span>
<span>                                alpha<span class="op">=</span><span class="fl">1</span>,maxiter<span class="op">=</span><span class="fl">100</span>,maxiter.pena <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="va">bootmodel</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">modelPaq1000</span></span>
<span>  </span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allboot</span><span class="op">&lt;-</span><span class="cn">NULL</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co">########################### all ######################################</span></span>
<span>  <span class="va">modelPaq1000</span><span class="op">&lt;-</span><span class="fu">HIDeM</span><span class="fu">::</span><span class="va">bootPaq1000</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">set</span><span class="op">&lt;-</span><span class="va">k</span></span>
<span></span>
<span>  <span class="va">bootk</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>coef<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span>,</span>
<span>                  names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span>,</span>
<span>                  transition<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"01"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"02"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"12"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               </span>
<span>                  id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">k</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">modelPaq1000</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">##################### combine ############################</span></span>
<span>  <span class="va">allboot</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bootk</span>,<span class="va">allboot</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="op">}</span></span>
<span> </span>
<span>  <span class="va">test</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">allboot</span>,<span class="va">coef</span><span class="op">~</span><span class="va">transition</span><span class="op">+</span><span class="va">names</span>,FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">test</span><span class="op">$</span><span class="va">coef</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">$</span><span class="va">coef</span><span class="op">/</span><span class="fl">50</span></span>
<span>  </span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">transition</span><span class="op">==</span><span class="st">"01"</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">plot</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">order</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">labs</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">$</span><span class="va">names</span></span>
<span>    </span>
<span>  <span class="va">p01</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">coef</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">order</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                    stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Variable"</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="va">labs</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">transition</span>,labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`01`<span class="op">=</span><span class="st">"Healthy to dementia"</span>,`02`<span class="op">=</span><span class="st">"Healthy to death"</span>,`12`<span class="op">=</span><span class="st">"Dementia to death"</span><span class="op">)</span><span class="op">)</span>,scales<span class="op">=</span><span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">" %selected (50 replicates)"</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">transition</span><span class="op">==</span><span class="st">"02"</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">plot</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">order</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">labs</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">$</span><span class="va">names</span></span>
<span> </span>
<span>  <span class="va">p02</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">coef</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">order</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                    stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">" "</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="va">labs</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">transition</span>,labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`01`<span class="op">=</span><span class="st">"Healthy to dementia"</span>,`02`<span class="op">=</span><span class="st">"Healthy to death"</span>,`12`<span class="op">=</span><span class="st">"Dementia to death"</span><span class="op">)</span><span class="op">)</span>,scales<span class="op">=</span><span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"%selected (500 replicates)"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">test</span><span class="op">[</span><span class="va">test</span><span class="op">$</span><span class="va">transition</span><span class="op">==</span><span class="st">"12"</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">plot</span><span class="op">$</span><span class="va">coef</span><span class="op">)</span>,<span class="op">]</span></span>
<span>  <span class="va">plot</span><span class="op">$</span><span class="va">order</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">labs</span><span class="op">&lt;-</span><span class="va">plot</span><span class="op">$</span><span class="va">names</span></span>
<span></span>
<span> </span>
<span>  <span class="va">p12</span><span class="op">&lt;-</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">coef</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">order</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                    stat<span class="op">=</span><span class="st">"identity"</span>,</span>
<span>                   color <span class="op">=</span> <span class="st">"black"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">" "</span>,breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">plot</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="va">labs</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="op">~</span><span class="va">transition</span>,labeller <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link">as_labeller</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`01`<span class="op">=</span><span class="st">"Healthy to dementia"</span>,`02`<span class="op">=</span><span class="st">"Healthy to death"</span>,`12`<span class="op">=</span><span class="st">"Dementia to death"</span><span class="op">)</span><span class="op">)</span>,scales<span class="op">=</span><span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">1</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"%selected (500 replicates)"</span><span class="op">)</span></span>
<span><span class="va">p01</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p02</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-11-2.png" width="576"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p12</span></span></code></pre></div>
<p><img src="Reg-IDM-ICT-Paq1000_files/figure-html/unnamed-chunk-11-3.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ariane Bercu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
